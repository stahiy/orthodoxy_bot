# Источники данных о православных храмах

## Найденные ресурсы с данными о храмах

### 1. Веб-сайты с большими базами данных

#### raspisaniebogosluzheniya.ru
- **Описание**: Более 22 646 храмов по всей России
- **Данные**: Расписание богослужений, адреса, время работы
- **URL**: https://raspisaniebogosluzheniya.ru/prav-hram
- **Особенности**: Очень большая база, но нет готового API

#### sobory.ru
- **Описание**: Интерактивная карта храмов с адресами и контактами
- **Данные**: Адреса, координаты (на карте), фотографии, описания
- **URL**: https://sobory.ru/karta/
- **Особенности**: Удобная карта, но нет API для экспорта

#### hramy.ru
- **Описание**: Иллюстрированный путеводитель по православным храмам России
- **Данные**: Структурировано по регионам и населенным пунктам
- **URL**: https://hramy.ru/
- **Особенности**: Хорошая структура, но веб-интерфейс без API

#### Портал открытых данных Москвы
- **Описание**: Список православных храмов Москвы
- **Данные**: Адреса, сайты, ближайшие станции метро
- **URL**: https://www.pravmir.ru/spisok-pravoslavnyih-hramov-moskvyi-opublikovan-na-portale-otkryityih-dannyih/
- **Особенности**: Возможен экспорт данных в открытом формате

### 2. Региональные ресурсы

#### Москва
- **raspisaniebogosluzheniya.ru**: 558 храмов Москвы
- **sobory.ru**: Список храмов Москвы на карте

#### Санкт-Петербург
- **peterburg.center**: Храмы с часами работы и адресами

#### Владивосток
- **russkiysobor.ru**: 63 храма с адресами, временем работы и контактами

#### Минск
- **sobor.by**: Расписание богослужений, адреса и телефоны храмов

## Варианты решения для получения данных

### Вариант 1: OpenStreetMap (Overpass API) ⭐ РЕКОМЕНДУЕТСЯ

**Преимущества:**
- ✅ Бесплатно и открыто
- ✅ Есть готовый API (Overpass API)
- ✅ Координаты, адреса, контакты
- ✅ Можно фильтровать по типу (православные храмы)
- ✅ Актуальные данные

**Пример запроса Overpass API:**
```javascript
[out:json][timeout:25];
(
  node["amenity"="place_of_worship"]["religion"="christian"]["denomination"="russian_orthodox"]({{bbox}});
  way["amenity"="place_of_worship"]["religion"="christian"]["denomination"="russian_orthodox"]({{bbox}});
);
out center;
```

**Документация:**
- Overpass API: https://wiki.openstreetmap.org/wiki/Overpass_API
- Overpass Turbo (тестирование запросов): https://overpass-turbo.eu/

### Вариант 2: Google Places API

**Преимущества:**
- ✅ Богатые данные: адреса, координаты, время работы, контакты, отзывы
- ✅ Высокое качество данных
- ✅ Актуальная информация

**Недостатки:**
- ❌ Платно (есть бесплатный лимит: $200/месяц)
- ❌ Требуется API ключ
- ❌ Ограничения по использованию

**Документация:**
- https://developers.google.com/maps/documentation/places/web-service

### Вариант 3: Парсинг с веб-сайтов

**Ресурсы для парсинга:**
- raspisaniebogosluzheniya.ru (22 646+ храмов)
- sobory.ru (карта храмов)
- hramy.ru (путеводитель)

**Недостатки:**
- ❌ Требуется разрешение владельцев сайтов
- ❌ Структура HTML может меняться
- ❌ Возможны проблемы с авторскими правами
- ❌ Нужно поддерживать парсер

### Вариант 4: Ручной сбор для конкретного региона

**Применение:**
- Для ограниченного количества храмов
- Для конкретного города/региона
- Для тестирования функционала

**Преимущества:**
- ✅ Полный контроль над данными
- ✅ Нет проблем с правами
- ✅ Можно добавить любые дополнительные поля

## Рекомендуемый подход

### Для начала: OpenStreetMap + локальная база

1. **Использовать Overpass API** для получения храмов по региону
2. **Сохранить в локальную базу** (JSON файл или БД)
3. **Дополнить данными** о времени работы и контактах из других источников
4. **Реализовать команду** `/churches` или `/храмы` в боте

### Структура данных для хранения

```php
'churches' => [
    [
        'name' => 'Храм Христа Спасителя',
        'address' => 'ул. Волхонка, 15, Москва',
        'latitude' => 55.7445,
        'longitude' => 37.6051,
        'phone' => '+7 (495) 637-12-76',
        'email' => 'info@xxc.ru',
        'website' => 'https://xxc.ru',
        'schedule' => [
            'weekdays' => '8:00 - 20:00',
            'saturday' => '8:00 - 20:00',
            'sunday' => '7:00 - 20:00'
        ],
        'services_schedule' => [
            'weekdays' => '8:00, 18:00',
            'saturday' => '8:00, 18:00',
            'sunday' => '7:00, 10:00, 18:00'
        ],
        'city' => 'Москва',
        'metro' => ['Кропоткинская'],
        'description' => 'Кафедральный соборный храм'
    ],
    // ...
]
```

## Возможный функционал в боте

### Команды для пользователей

1. **`/churches [город]`** — список храмов в указанном городе
   - Пример: `/churches Москва`
   - Выводит список с адресами и кнопками для детальной информации

2. **`/church [название]`** — информация о конкретном храме
   - Пример: `/church Храм Христа Спасителя`
   - Выводит полную информацию: адрес, время работы, расписание служб, контакты

3. **`/churches_nearby`** — храмы рядом (по геолокации)
   - Пользователь отправляет свою геолокацию
   - Бот находит ближайшие храмы (например, в радиусе 5 км)

4. **`/churches_map`** — отправка карты с храмами
   - Inline карта с отметками храмов
   - Кнопка "Открыть на карте" для каждого храма

### Дополнительные возможности

- **Расписание богослужений** на сегодня/завтра
- **Фильтрация** по типу храма (собор, церковь, часовня)
- **Поиск** по названию или адресу
- **Уведомления** о богослужениях (если пользователь подписан на конкретный храм)

## Технические детали реализации

### Использование Overpass API в PHP

```php
// Пример запроса к Overpass API
$overpassUrl = "https://overpass-api.de/api/interpreter";
$query = '[out:json][timeout:25];
(
  node["amenity"="place_of_worship"]["religion"="christian"]["denomination"="russian_orthodox"](55.5,37.3,55.9,37.8);
  way["amenity"="place_of_worship"]["religion"="christian"]["denomination"="russian_orthodox"](55.5,37.3,55.9,37.8);
);
out center;';

$ch = curl_init($overpassUrl);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $query);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$response = curl_exec($ch);
curl_close($ch);

$data = json_decode($response, true);
```

### Хранение данных

**Вариант 1: JSON файл** (для начала)
- `storage/churches.json` — массив храмов
- Простое чтение/запись
- Подходит для небольшого количества храмов

**Вариант 2: База данных** (для масштабирования)
- Таблица `churches` с полями: id, name, address, latitude, longitude, phone, schedule, city, etc.
- Индексы для быстрого поиска
- Подходит для большого количества храмов

### Интеграция с Telegram

- **Inline Keyboard** для навигации по храмам
- **Location** для отправки геолокации храма
- **Callback queries** для детальной информации
- **Geolocation** для поиска ближайших храмов

## Примечания

- При использовании данных с веб-сайтов необходимо соблюдать авторские права
- Рекомендуется получить разрешение владельцев ресурсов перед парсингом
- OpenStreetMap — открытый источник, можно использовать свободно
- Данные о времени работы могут устаревать, нужна периодическая актуализация

